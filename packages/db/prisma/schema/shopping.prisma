enum ListShareRole {
  OWNER
  PARTICIPANT
}

enum ListShareStatus {
  PENDING
  ACTIVE
}

enum UnitOfMeasure {
  KG
  ML
  UN
}

model ShoppingList {
  id        String   @id @default(cuid())
  name      String
  ownerId   String
  owner     User     @relation("ListOwner", fields: [ownerId], references: [id], onDelete: Cascade)
  items     ShoppingItem[]
  shares    ListShare[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([ownerId])
  @@map("shopping_list")
}

model ShoppingItem {
  id        String   @id @default(cuid())
  listId    String
  list      ShoppingList @relation(fields: [listId], references: [id], onDelete: Cascade)
  name      String
  quantity  Float?
  price     Float?
  market    String?
  unitOfMeasure UnitOfMeasure @default(UN)
  checked   Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([listId])
  @@map("shopping_item")
}

model ListShare {
  id            String          @id @default(cuid())
  listId        String
  inviterId     String
  inviteeEmail  String
  inviteeUserId String?
  role          ListShareRole   @default(PARTICIPANT)
  status        ListShareStatus @default(PENDING)
  list          ShoppingList    @relation(fields: [listId], references: [id], onDelete: Cascade)
  inviter       User            @relation("ListShareInviter", fields: [inviterId], references: [id], onDelete: Cascade)
  inviteeUser   User?           @relation("ListShareInvitee", fields: [inviteeUserId], references: [id], onDelete: SetNull)
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt

  @@unique([listId, inviteeEmail])
  @@index([inviteeEmail])
  @@index([inviteeUserId])
  @@map("list_share")
}
